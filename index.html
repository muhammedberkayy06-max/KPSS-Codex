<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KPSS Dijital KoÃ§ â€“ Ultimate</title>
  <meta name="theme-color" content="#0A84FF">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data: https://cdn.jsdelivr.net https://huggingface.co; style-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdn.jsdelivr.net; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://cdn.jsdelivr.net; connect-src 'self' https://huggingface.co https://*.hf.space https://cdn.jsdelivr.net data:; font-src 'self' data: https://cdn.jsdelivr.net; manifest-src 'self'; frame-ancestors 'self'; base-uri 'self';" />
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="icons/icon-192.png">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="styles.css">
  <script>
    window.MathJax = {
      tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body class="bg-slate-50 text-slate-900">
  <div class="bg"></div>
  <header class="topbar">
    <div class="brand">
      <div class="logo">K</div>
      <div class="title">
        <div class="h1">KPSS Dijital KoÃ§</div>
        <div class="sub">Ultimate Â· Apple tarzÄ± Â· Tailwind</div>
      </div>
    </div>
    <div class="top-actions">
      <button id="btnHome" class="chip">ğŸ  Ana sayfa</button>
      <button id="btnInstall" class="chip" style="display:none">ğŸ“± Ana ekrana ekle</button>
      <button id="btnUpdate" class="chip">âš¡ GÃ¼ncellemeleri denetle</button>
      <button id="btnExport" class="chip">ğŸ—‚ï¸ Verileri indir</button>
    </div>
  </header>

  <main class="container space-y-6">
    <section class="card hero-card">
      <div class="hero-grid">
        <div class="hero-left">
          <p class="eyebrow">Yeni gÃ¶rÃ¼nÃ¼m</p>
          <h1 class="hero-title">KPSS Dijital KoÃ§ â€“ Ultimate</h1>
          <p class="hero-sub">Modern sekmeler, hÄ±zlÄ± kÄ±sayollar ve canlÄ± kartlarla ders Ã§alÄ±ÅŸmayÄ± hÄ±zlandÄ±rdÄ±k.</p>
          <div class="hero-actions row">
            <button class="btn primary sm" data-scroll="setupCard">ğŸš€ Teste baÅŸla</button>
            <button class="btn ghost sm" data-scroll="aiCard">ğŸ¤– Yapay zeka paneli</button>
            <button class="btn ghost sm" data-scroll="aiExamCard">ğŸ§  120/200 soruluk denemeler</button>
          </div>
        </div>
        <div class="hero-stats">
          <div class="stat-tile">
            <div class="stat-value" id="statQuestions">â€“</div>
            <div class="stat-label">Toplam soru</div>
          </div>
          <div class="stat-tile">
            <div class="stat-value" id="statLessons">â€“</div>
            <div class="stat-label">Ders</div>
          </div>
          <div class="stat-tile">
            <div class="stat-value" id="statVersion">v16</div>
            <div class="stat-label">SÃ¼rÃ¼m</div>
          </div>
        </div>
      </div>
      <div class="nav-bar" id="navShortcuts">
        <button class="nav-link active" data-scroll="setupCard">HazÄ±rlÄ±k</button>
        <button class="nav-link" data-scroll="aiCard">AI Ã¼retici</button>
        <button class="nav-link" data-scroll="aiExamCard">AI deneme</button>
        <button class="nav-link" data-scroll="quizCard">CanlÄ± test</button>
        <button class="nav-link" data-scroll="resultsCard">SonuÃ§lar</button>
      </div>
    </section>

    <div id="loadStatus" class="notice" hidden></div>

    <div id="alertBox" class="notice flex items-start gap-3" hidden>
      <div class="flex-1" id="alertText"></div>
      <button id="alertClose" class="chip">Kapat</button>
    </div>

    <section id="diagPanel" class="card space-y-3" hidden>
      <div class="flex items-start justify-between gap-3 flex-wrap">
        <div>
          <p class="text-sm text-slate-500 font-semibold uppercase">TeÅŸhis</p>
          <h3 class="text-xl font-extrabold">Hata GÃ¼nlÃ¼ÄŸÃ¼</h3>
          <p class="hint">AÄŸ ve veri hatalarÄ± burada gÃ¶rÃ¼nÃ¼r; JSON/AI sorunlarÄ±nÄ± hÄ±zlÄ±ca tespit etmek iÃ§in kullan.</p>
        </div>
        <div class="row gap-2">
          <button id="btnDiagExport" class="btn sm ghost">ğŸ’¾ DÄ±ÅŸa aktar</button>
          <button id="btnDiagClear" class="btn sm">ğŸ§¹ Temizle</button>
        </div>
      </div>
      <ol id="diagList" class="diag-list"></ol>
    </section>

    <section id="setupCard" class="card space-y-5">
      <div class="flex items-center justify-between gap-4 flex-wrap">
        <div class="flex flex-col">
          <p class="text-sm text-slate-500 font-semibold uppercase">BaÅŸlangÄ±Ã§</p>
          <h2 class="text-2xl font-extrabold">Ders & Mod SeÃ§imi</h2>
        </div>
        <div class="seg" id="modeSwitch">
          <button class="seg-btn mode-btn active" data-mode="single">Tek Ders</button>
          <button class="seg-btn mode-btn" data-mode="gkgy">GK-GY</button>
          <button class="seg-btn mode-btn" data-mode="a">A Grubu</button>
        </div>
      </div>

      <div class="grid gap-4 md:grid-cols-2" id="fieldLesson">
        <div class="field">
          <label for="lessonSelect">Ders</label>
          <select id="lessonSelect" class="w-full"></select>
          <p class="hint">Soru bankasÄ± otomatik yÃ¼klenir.</p>
        </div>
        <div class="field">
          <label for="countInput">Soru SayÄ±sÄ±</label>
          <input id="countInput" type="number" min="5" max="300" value="10" class="w-full">
          <p id="countHint" class="hint">Tek ders pratik: 5-300 arasÄ± seÃ§ebilirsin.</p>
        </div>
      </div>

      <div class="icon-grid" id="lessonIcons"></div>

      <div class="grid gap-4 md:grid-cols-3">
        <div class="field">
          <label for="goal">Hedef</label>
          <select id="goal">
            <option value="speed">HÄ±z</option>
            <option value="mastery">Eksik Konu</option>
          </select>
        </div>
        <div class="field">
          <label for="difficulty">Zorluk</label>
          <select id="difficulty">
            <option value="auto">Otomatik</option>
            <option value="easy">Kolay</option>
            <option value="medium">Orta</option>
            <option value="hard">Zor</option>
          </select>
        </div>
        <div class="field flex flex-col justify-end">
          <label class="toggle"><input id="ttsToggle" type="checkbox">CevaplarÄ± sesli oku</label>
        </div>
      </div>

      <div class="row actions">
        <button id="btnStart" class="btn primary">ğŸš€ Testi BaÅŸlat</button>
        <button id="btnQuickStart" class="btn success" style="display:none">â–¶ BaÅŸlat</button>
        <button id="btnQuick10" class="btn">ğŸ¯ 2 saatlik plan</button>
        <button id="btnRead" class="btn sm">ğŸ”Š Soruyu oku</button>
        <button id="btnVoice" class="btn sm">ğŸ™ï¸ Sesli komut</button>
      </div>
    </section>

    <section id="aiCard" class="card space-y-4">
      <div class="flex items-start justify-between gap-4 flex-wrap">
        <div>
          <p class="text-sm text-slate-500 font-semibold uppercase">Ãœcretsiz yapay zeka</p>
          <h3 class="text-xl font-extrabold">Ä°nternet + Yerel Soru Ãœretici</h3>
          <p class="hint">Hugging Face (Ã¼cretsiz, internet) veya yerel Ã¼reticiyle sÄ±nÄ±rsÄ±z soru ekleyebilirsin.</p>
        </div>
        <button id="btnAiGenerate" class="btn sm primary">ğŸ¤– Yapay soru Ã¼ret</button>
      </div>

      <div class="grid gap-4 md:grid-cols-3">
        <div class="field">
          <label for="aiLesson">Ders</label>
          <select id="aiLesson" class="w-full"></select>
        </div>
        <div class="field">
          <label for="aiCount">Adet</label>
          <input id="aiCount" type="number" min="1" max="20" value="3" class="w-full">
          <p class="hint">Ãœretim sonrasÄ± ders bankasÄ±na eklenir, Ã§evrimdÄ±ÅŸÄ± da kalÄ±r.</p>
        </div>
        <div class="field">
          <label>Durum</label>
          <div id="aiStatus" class="hint">HazÄ±r Â· internet veya yerel Ã¼retim</div>
        </div>
      </div>

      <div class="grid gap-4 md:grid-cols-3">
        <div class="field">
          <label for="aiProvider">Ãœretici</label>
          <select id="aiProvider" class="w-full">
            <option value="hf">Hugging Face (Ã¼cretsiz, internet)</option>
            <option value="local">Yerel (offline)</option>
          </select>
          <p class="hint">Hugging Face seÃ§ildiÄŸinde en yÃ¼ksek kapasite iÃ§in Ã¼cretsiz community endpoint kullanÄ±lÄ±r.</p>
        </div>
        <div class="field">
          <label for="hfToken">HF Token (opsiyonel)</label>
          <input id="hfToken" type="password" class="w-full" placeholder="hf_...">
          <p class="hint">Ãœcretsiz eriÅŸim iÃ§in token ekleyebilirsin; boÅŸ bÄ±rakÄ±rsan halka aÃ§Ä±k quota kullanÄ±lÄ±r.</p>
        </div>
        <div class="field">
          <label for="hfModel">HF Model</label>
          <input id="hfModel" type="text" class="w-full" value="HuggingFaceH4/zephyr-7b-beta">
          <p class="hint">Topik listesine gÃ¶re JSON dÃ¶nen Ã¼retim ister. Dilersen baÅŸka Ã¼cretsiz modeli yazabilirsin.</p>
        </div>
      </div>
    </section>

    <section id="aiExamCard" class="card space-y-4">
      <div class="flex items-start justify-between gap-4 flex-wrap">
        <div>
          <p class="text-sm text-slate-500 font-semibold uppercase">AI deneme Ã¼retici</p>
          <h3 class="text-xl font-extrabold">GK-GY 120 & A Grubu 200 soruluk sÄ±nav</h3>
          <p class="hint">Her tÄ±klama yeni sekmede yepyeni sorularla deneme oluÅŸturur. Ä°nternet tabanlÄ± Hugging Face Ã¼retimi, eksik kaldÄ±ÄŸÄ±nda yerel Ã¼reticiyle tamamlanÄ±r.</p>
        </div>
        <div class="pill">Ãœcretsiz Â· Ä°nternet + Yerel yedek</div>
      </div>

      <div class="grid gap-4 md:grid-cols-2">
        <div class="field space-y-2">
          <div>
            <label>GY-GK (120 soru)</label>
            <p class="hint">TÃ¼rkÃ§e 30, Matematik 30, Tarih 27, CoÄŸrafya 18, VatandaÅŸlÄ±k 15.</p>
          </div>
          <button id="btnExamGK" class="btn primary w-full">ğŸ§  120 soruluk GK-GY AI deneme</button>
        </div>
        <div class="field space-y-2">
          <div>
            <label>A Grubu (200 soru)</label>
            <p class="hint">Kamu YÃ¶netimi, Ä°ktisat, Ã‡alÄ±ÅŸma Ekonomisi, Hukuk, UluslararasÄ± Ä°liÅŸkiler'den 40'ar soru.</p>
          </div>
          <button id="btnExamA" class="btn w-full">ğŸ›ï¸ 200 soruluk A Grubu AI deneme</button>
        </div>
      </div>
      <p class="hint">Yeni sekmede aÃ§Ä±lÄ±r, yazdÄ±rÄ±labilir/PDF alÄ±nabilir. Daha yÃ¼ksek kapasite iÃ§in Hugging Face token ekleyebilirsin (Ã¼cretsiz community eriÅŸimi).</p>
    </section>

    <section id="quizCard" class="card space-y-4" hidden>
      <div class="quiz-top">
        <span id="pillMeta" class="pill">Ders Â· Konu</span>
        <div class="quiz-right">
          <div class="scorebox">
            <div class="score">XP: <span id="xp">0</span></div>
            <div class="score">Seri: <span id="streak">0</span> gÃ¼n</div>
            <div class="score">Ä°lerleme: <span id="counter">0/0</span></div>
          </div>
          <div class="progress"><div id="bar" class="bar"></div></div>
        </div>
      </div>

      <h3 id="qTitle" class="qtitle">Soru metni</h3>
      <div id="qParagraph" class="paragraph" hidden></div>

      <div id="options" class="options"></div>

      <div id="explain" class="explain" hidden>
        <div class="explain-head">
          <span id="tagResult" class="tag">SonuÃ§</span>
          <button id="btnWhy" class="btn sm">ğŸ“Œ KazanÄ±m</button>
        </div>
        <div id="explainText" class="mt-2 leading-relaxed"></div>
        <div id="coachTip" class="coach"></div>
      </div>

      <div class="row actions">
        <div class="seg">
          <button id="btnPrev" class="seg-btn" data-mode="prev">Ã–nceki</button>
          <button id="btnSkip" class="seg-btn" data-mode="skip">Pas</button>
          <button id="btnNext" class="seg-btn" data-mode="next">Sonraki</button>
        </div>
        <button id="btnFinish" class="btn danger">ğŸ Testi Bitir</button>
      </div>
    </section>

    <section id="resultsCard" class="card space-y-4" hidden>
      <div class="flex items-center justify-between gap-3 flex-wrap">
        <h2 class="text-xl font-extrabold">SonuÃ§lar</h2>
        <div class="row">
          <button id="btnShare" class="btn sm">ğŸ“¤ PaylaÅŸ</button>
          <button id="btnRestart" class="btn sm">ğŸ”„ Yeni Test</button>
        </div>
      </div>
      <p id="summary" class="text-base"></p>
      <canvas id="chart" height="120" class="w-full"></canvas>
      <div id="topicMap" class="topics"></div>
      <div class="plan" id="plan"></div>
    </section>
  </main>

  <script src="banks.js" defer></script>
  <script src="app.js" defer></script>
</body>
</html>
